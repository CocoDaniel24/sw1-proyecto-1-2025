<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editor de Diagramas de Clases</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/pizarra.css">

    <style>
     
    </style>
  </head>
  <body>
    <div class="main-container">


      <div class="floating-toolbar">
        <a href="./dashboard.html" class="toolbar-item" title="Volver al Dashboard">
          <i class="fa fa-home"></i>
        </a>
        
        <div class="toolbar-divider"></div>
        
        <div class="toolbar-item" draggable="true" data-tool="class" title="Clase">
          <i class="fas fa-th-large" style="color: #2563eb;"></i>
        </div>

        <div class="toolbar-item" draggable="true" data-tool="interface" title="Interfaz">
          <i class="fas fa-circle" style="color: #16a34a;"></i>
        </div>

        <div class="toolbar-item" draggable="true" data-tool="abstract" title="Clase Abstracta">
          <i class="fas fa-th-large" style="color: #9333ea;"></i>
        </div>

        <div class="toolbar-item" draggable="true" data-tool="enum" title="Enumeración">
          <i class="fas fa-list-ul" style="color: #dc2626;"></i>
        </div>

        <div class="toolbar-item" draggable="true" data-tool="note" title="Nota">
          <i class="fas fa-comment-dots" style="color: #f97316;"></i>
        </div>

      </div>


      <div class="canvas-container">
        <!-- Barra de colaboración -->
        <div class="collaboration-header" id="collaboration-header">
          <!-- <div class="users-online">
            <i class="fas fa-users me-2"></i>
            <span id="user-count">1 usuarios </span>
            <div id="user-avatars" class="ms-3"></div>
          </div> -->
          <div class="users-online">
            <i class="fas fa-users me-2"></i>
            <span id="user-count"></span>
            <div id="user-avatars" class="ms-3">
            </div>
          </div>
          <div class="sync-status">
            <div class="sync-indicator" id="sync-indicator"></div>
            <span id="sync-text">Sincronizado</span>
          </div>
        </div>
        <div class="canvas-header d-flex align-items-center">
          <h5 class="mb-0 text-muted">
            <i class="fas fa-project-diagram me-2"></i>
          </h5>

          <div class="ms-auto d-flex align-items-center gap-2">
            <!-- Zoom out (secondary) -->
            <button
              class="btn btn-outline-secondary btn-sm icon-btn"
              onclick="CanvasManager.zoomOut()"
              title="Alejar (Zoom out)"
              aria-label="Zoom out"
            >
              <i class="fas fa-search-minus"></i>
            </button>

            <span class="align-self-center text-muted small" id="zoom-level"
              >100%</span
            >

            <!-- Zoom in (secondary, distinto botón pero mismo grupo de zoom) -->
            <button
              class="btn btn-outline-secondary btn-sm icon-btn"
              onclick="CanvasManager.zoomIn()"
              title="Acercar (Zoom in)"
              aria-label="Zoom in"
            >
              <i class="fas fa-search-plus"></i>
            </button>

            <!-- Ver XML/JSON (info) -->
            <button
              class="btn btn-outline-info btn-sm icon-btn"
              onclick="SalaManager.showXmlViewer()"
              title="Ver XML/JSON"
              aria-label="Ver XML/JSON"
            >
              <i class="fas fa-code"></i>
            </button>

            <!-- Limpiar Todo (danger) -->
            <button
              class="btn btn-outline-danger btn-sm icon-btn"
              onclick="DiagramManager.clearAll()"
              title="Limpiar todo"
              aria-label="Limpiar"
            >
              <i class="fas fa-trash"></i>
            </button>

            <!-- INPORTAR (success) -->
            <button
              class="btn btn-outline-success btn-sm icon-btn"
              onclick="DiagramManager.importDiagram()"
              title="Importar diagrama
              aria-label="Importar"
            >
              <i class="fas fa-upload"></i>
            </button>



            <!-- Exportar (primary) -->
            <button
              class="btn btn-outline-primary btn-sm icon-btn"
              onclick="DiagramManager.exportDiagram()"
              title="Exportar diagrama"
              aria-label="Exportar"
            >
              <i class="fas fa-download"></i>
            </button>

            <!-- Exportar Spring Boot (success-dark: dark para que sea único) -->
            <button
              class="btn btn-outline-dark btn-sm icon-btn"
              onclick="DiagramManager.exportSpringBoot()"
              title="Exportar Spring Boot"
              aria-label="Exportar Spring Boot"
            >
              <!-- Ícono Spring -->
              <img
                src="https://www.svgrepo.com/show/376350/spring.svg"
                alt="Spring Boot"
              />
            </button>

          </div>
        </div>
        <div class="canvas-wrapper" style="top: 110px">
          <div class="canvas" id="canvas">
            <svg class="connections-svg" id="connections">
              <defs>
                <marker
                  id="arrowhead"
                  markerWidth="10"
                  markerHeight="8"
                  refX="9"
                  refY="4"
                  orient="auto"
                >
                  <polygon points="0 0, 10 4, 0 8" fill="#475569" />
                </marker>
                <marker
                  id="arrowhead-rev"
                  markerWidth="10"
                  markerHeight="8"
                  refX="1"
                  refY="4"
                  orient="auto-start-reverse"
                >
                  <polygon points="10 0, 0 4, 10 8" fill="#475569" />
                </marker>
                <marker
                  id="diamond"
                  markerWidth="14"
                  markerHeight="14"
                  refX="12"
                  refY="7"
                  orient="auto"
                >
                  <path
                    d="M 0,7 L 7,0 L 14,7 L 7,14 Z"
                    fill="white"
                    stroke="#475569"
                    stroke-width="1"
                  />
                </marker>
                <marker
                  id="filledDiamond"
                  markerWidth="14"
                  markerHeight="14"
                  refX="12"
                  refY="7"
                  orient="auto"
                >
                  <path
                    d="M 0,7 L 7,0 L 14,7 L 7,14 Z"
                    fill="#475569"
                    stroke="#475569"
                    stroke-width="1"
                  />
                </marker>
                <marker
                  id="diamond-rev"
                  markerWidth="14"
                  markerHeight="14"
                  refX="2"
                  refY="7"
                  orient="auto-start-reverse"
                >
                  <path
                    d="M 14,7 L 7,0 L 0,7 L 7,14 Z"
                    fill="white"
                    stroke="#475569"
                    stroke-width="1"
                  />
                </marker>
                <marker
                  id="filledDiamond-rev"
                  markerWidth="14"
                  markerHeight="14"
                  refX="2"
                  refY="7"
                  orient="auto-start-reverse"
                >
                  <path
                    d="M 14,7 L 7,0 L 0,7 L 7,14 Z"
                    fill="#475569"
                    stroke="#475569"
                    stroke-width="1"
                  />
                </marker>
                <marker
                  id="inheritance"
                  markerWidth="14"
                  markerHeight="14"
                  refX="12"
                  refY="7"
                  orient="auto"
                >
                  <path
                    d="M 0,0 L 14,7 L 0,14 Z"
                    fill="white"
                    stroke="#475569"
                    stroke-width="1.5"
                  />
                </marker>
                <marker
                  id="inheritance-rev"
                  markerWidth="14"
                  markerHeight="14"
                  refX="2"
                  refY="7"
                  orient="auto-start-reverse"
                >
                  <path
                    d="M 14,0 L 0,7 L 14,14 Z"
                    fill="white"
                    stroke="#475569"
                    stroke-width="1.5"
                  />
                </marker>
                <marker
                  id="triangle"
                  markerWidth="10"
                  markerHeight="10"
                  refX="1"
                  refY="5"
                  orient="auto"
                >
                  <path
                    d="M 0,0 L 10,5 L 0,10 Z"
                    fill="white"
                    stroke="#475569"
                    stroke-width="1"
                  />
                </marker>
              </defs>
            </svg>
          </div>
        </div>
      </div>

      

      <!-- <button
        class="ai-chatbot-toggle"
        id="ai-chatbot-toggle"
        onclick="AIChatbot.openChatbot()"
      >
        <i class="fas fa-robot"></i>
      </button> -->
      <!-- <div class="ai-chatbot" id="ai-chatbot">
        <div class="ai-chatbot-header">
          <div class="ai-chatbot-title" onclick="AIChatbot.toggleMinimize()">
            <i class="fas fa-robot"></i>
            AI Diagram Generator
          </div>
          <div class="ai-chatbot-controls">
            <button
              class="ai-control-btn"
              onclick="AIChatbot.toggleMinimize()"
              title="Minimizar/Maximizar"
            >
              <i id="minimize-icon" class="fas fa-minus"></i>
            </button>
            <button
              class="ai-control-btn ai-close-btn"
              onclick="AIChatbot.closeChatbot()"
              title="Cerrar chatbot"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>

        <div class="ai-chatbot-content">
          <div class="ai-chat-messages" id="ai-chat-messages">
            <div class="ai-message bot">
              <div class="ai-message-bubble">
                👋 ¡Hola! Soy tu asistente de IA para crear diagramas de clases.
                Puedes enviarme texto, grabaciones de voz o imágenes
                describiendo lo que necesitas, y yo generaré automáticamente el
                diagrama UML para ti.
              </div>
            </div>
          </div>
          <div class="ai-input-panel">
            <div class="ai-input-modes">
              <button
                class="ai-mode-btn active"
                data-mode="text"
                onclick="AIChatbot.setMode('text')"
              >
                <i class="fas fa-keyboard"></i>
                <span>Texto</span>
              </button>
              <button
                class="ai-mode-btn"
                data-mode="voice"
                onclick="AIChatbot.setMode('voice')"
              >
                <i class="fas fa-microphone"></i>
                <span>Voz</span>
              </button>
              <button
                class="ai-mode-btn"
                data-mode="image"
                onclick="AIChatbot.setMode('image')"
              >
                <i class="fas fa-image"></i>
                <span>Imagen</span>
              </button>
            </div>
            <div class="ai-input-area">
              <textarea
                class="ai-text-input"
                id="ai-text-input"
                placeholder="Describe el diagrama que quieres crear..."
                rows="1"
                onkeypress="AIChatbot.handleKeyPress(event)"
              ></textarea>

           
              <input
                type="file"
                class="ai-file-upload"
                id="ai-file-input"
                accept="image/*"
                onchange="AIChatbot.handleFileUpload(event)"
              />
              <button
                class="ai-send-btn"
                id="ai-send-btn"
                onclick="AIChatbot.sendMessage()"
              >
                <i class="fas fa-paper-plane" id="send-icon"></i>
              </button>
            </div>
          </div>
        </div>
      </div> -->
    </div>
      <!-- Panel de Propiedades -->
       <div class="properties-panel">
        <div class="properties-header">
          <i class="fas fa-cog me-2"></i>
          Propiedades
        </div>
        <div id="properties-content">
          <div class="text-center text-muted p-4">
            <i class="fas fa-mouse-pointer fa-2x mb-3"></i>
            <p>Selecciona un elemento para ver sus propiedades</p>
          </div>
        </div>
      </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="./js/pizarra.js"></script>
    <script>
 
    </script>
  </body>
</html>
